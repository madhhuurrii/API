# Symbl API Documentation
## Flow of Contents
- [Introduction](#introduction)
- [Authentication](#authentication)
- [GET Insights](#get-insights)
  - [HTTP Request](#1-http-request)
  - [Sample API Call : cURL](#2-sample-api-call-curl)
  - [Response](#3-response)
  - [Response Object](#4-response-object)
  - [Possible Errors](#5-possible-errors)
- [Testing](#testing)
## Introduction 
Symbl APIs uses the RESTful Web API architecture. This means the HTTP methods are used to access resources via URL and transmit JSON based data.
Symbl API follows secure requests i.e `https`, not `http` and returns JSON-encoded responses.

|     Base URL              |      Endpoint       | 
| --------------------------|---------------------|
| `https://api.symbl.ai/v1` | `/v1/conversations` |

## Authentication 
Symbl APIs follows the OAuth 2.0 protocol, In order to authenticate you will need an access token. 
The Access tokens can be generated by following the below two step process.

#### 1. Obtain API Credentials from Symbl Platform
- Register, If you do not have an account in Symbl platform or else Log in.
- After logging in, you will be redirected to the home page, here copy your App ID and App secret.
  
  ![image](https://user-images.githubusercontent.com/64744084/146662224-79216d24-27d6-4580-8c29-22bd9a9a6f89.png)

 API Credentials are always required to generate the Access token. 
           
 #### 2. Using these credentials, generate the Access token
 - Next, to generate Access Token make POST request to the following endpoint
 `https://api.symbl.ai/oauth2/token:generate`
 
  for example using cURL:
  ```curl
  curl -k -X POST "https://api.symbl.ai/oauth2/token:generate" \
     -H "accept: application/json" \
     -H "Content-Type: application/json" \
     -d $'{
      "type" : "application",
      "appId": "'$APP_ID'",
      "appSecret": "'$APP_SECRET'"
    }'
  ```
  Here replace the `$APP_ID` and `$APP_SECRET` with acutal App Id and App Secret respectively.
 - After succesful completion, a message apears as shown below
 ```
 {
   "accessToken": "your_accessToken",
   "expiresIn": 86400
 }
 ```
 with following parameters:
|  Parameter      |    Description       | 
| --------------- |----------------------|
|  `accessToken`  |  Authorization Token |
|  `expiresIn`    | Duration in seconds in which the access token is valid |

- Else possible errors can be displayed

| Error Codes          |    Description       | 
| ---------------------|----------------------|
|  `401 Unauthorized`  |  The `appId` or `appSecret` is invalid|

## GET Insights
An Insight is a form of question or text that needs immediate understanding of significance about an event or action in a conversation.

The Insights API returns a JSON which consists of text, ususally of type question in a conversation.

### 1. HTTP Request 
```
GET https://api.symbl.ai/v1/conversations/{conversationId}/insights
```
The `{conversationId}` mentioned in the above text can be obtained by following the instruction in [POST Text API](https://docs.symbl.ai/docs/async-api/overview/text/post-text)

In this request the `conversationId` can be replaced as `5526632414576640`, replace this in the actual link.

### 2. Sample API call : cURL
```
curl --location --request GET 'https://api.symbl.ai/v1/conversations/5526632414576640/insights' \
  --header 'x-api-key:'
  # The colon prevents curl from asking for a password.
  
```
#### Request Headers
| Header Name        | Description   |
| -------------------|------------------------------------------------------------------|
| `x-api-key`        | JWT token you get from [authentication process](#authentication) |

### 3. Response 
```json
{
"insights": [

{
"id": "5288719680536576",
"text": "How was the difference there?",
"type": "question",
"score": 0.9827664988519251,
"messageIds": [
"5549178644070400"

],
"from": {}
},
{
"id": "5660876935790592",
"text": "Did you want navy blue or royal blue?",
"type": "question",
"score": 0.9921441245153866,
"messageIds": [
"5213026535866368"
],
"from": {}
},
{
"id": "5810274487500800",
"text": "What color did you want the New Yorker in?",
"type": "question",
"score": 0.9963072322074725,
"messageIds": [
"5861300292812800"

],
"from": {}
},
{
"id": "6037045170405376",
"text": "Sure what I need to do?",
"type": "question",
"score": 0.9081042802022934,
"messageIds": [
"5191824211705856"
],
"from": {}
},
{
"id": "6098067562430464",

"text": "Okay, what ZIP code are you located in 1940, 6?",
"type": "question",
"score": 0.9296213757388787,
"messageIds": [
"5582660145512448"
],
"from": {}
},
{
"id": "6404582466912256",
"text": "Yes, ma'am and Mr. Johnson, do you have the Parker scarf in light blue with you now?",
"type": "question",

"score": 0.9915077116276262,
"messageIds": [
"4936662100475904"
],
"from": {}
},
]
}

```

### 4. Response Object 
| Field        | Type   | Description                                                 |
| -------------|--------|-------------------------------------------------------------|
| `id`         | string | A unique identifier for the insights.                       |
| `text`       | string | conversation text                                           |
| `type`       | string | Insight response type                                       |
| `score`      | number | Score of generated insights                                 |
| `messageIds` | string | A unique message identifier for the corresponding message   |
| `from`       | object | Can have information of speaker in key-value pair           |

### 5. Possible Errors
| Error Code        | Description                                             |
| ------------------|---------------------------------------------------------|
| 401 Unauthorized  | The access token is invalid or has been revoked.        |
| 403 Forbidden     | The conversationId in the request path points to the wrong conversation.        |

## Testing using Postman 
POSTMAN is an API client used to develop, test, share and document APIs. It is used for backend testing where we enter the end-point URL, it sends the request to the server and receives the response back from the server.

[![Run in Postman](https://run.pstmn.io/button.svg)](https://god.gw.postman.com/run-collection/13497402-108cafc3-da45-4b00-97fe-4819894f58bb?action=collection%2Ffork&collection-url=entityId%3D13497402-108cafc3-da45-4b00-97fe-4819894f58bb%26entityType%3Dcollection%26workspaceId%3D5f563cfe-42ef-4344-a98a-eae13183fb7c)

Symbl APIs can be tested in Postman, but before testing ensure that you have `App Id` and `App Secret` to authenticate the API requests.

Symbl's public collection in Postman has preconfigured API request that can help you get started in one click!
